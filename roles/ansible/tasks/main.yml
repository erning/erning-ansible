---
- name: ensure ~/apps directory is ready
  file: path=~/apps
        state=directory
        recurse=yes

- name: clone ansible
  git: repo=https://github.com/ansible/ansible.git
       dest=~/apps/ansible
       update={{ update_ansible }}

- name: virtualenv for ansible
  debug: msg="create .virtualenv and install paramiko jinja2 PyYAML"

- name: ensure ansible wrapper is ready
  template: src=_ansible-wrapper
            dest=~/bin/_ansible-wrapper
            mode=0755

- name: ensure ansible binaries are linked
  file: src=~/bin/_ansible-wrapper
        dest=~/bin/{{ item }}
        state=link
  with_items:
    - ansible
    - ansible-playbook
    - ansible-pull
    - ansible-doc
